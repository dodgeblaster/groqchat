import d from"http";import g from"fs";import u from"url";function h(s){return g.readFileSync(s,{encoding:"utf-8"})}function y(){let s="public/",l=[];return{front:r=>{s=r},api:(r,f)=>{l.push({path:r,method:"POST",fn:f})},start:(r=3e3)=>{d.createServer(async(i,e)=>{let p=u.parse(i.url,!0);if(i.method==="GET"){let n=p.pathname;if(n==="/"){e.writeHead(200,{"Content-Type":"text/html"});let m=h(s+"index.html");e.end(m);return}let o=s+n,t=n.split(".")[1],c=h(o),a="text/plain";t==="html"&&(a="text/html"),t==="css"&&(a="text/css"),t==="js"&&(a="application/javascript"),t==="png"&&(a="image/png"),t==="jpeg"&&(a="image/jpeg"),t==="jpg"&&(a="image/jpeg"),e.writeHead(200,{"Content-Type":a}),e.end(c);return}console.log(p.pathname);for(let n of l)if(i.method===n.method&&i.method==="POST"&&p.pathname==="/api"+n.path)try{let o="";i.on("data",t=>{o+=t.toString()}),i.on("end",async()=>{let t=JSON.parse(o),c=await n.fn(t);e.writeHead(200,{"Content-Type":"application/json","Access-Control-Allow-Origin":"http://localhost:3000"}),e.end(JSON.stringify(c))})}catch(o){console.error("Error parsing JSON:",o);let t={status:"error",message:o.message};e.writeHead(400,{"Content-Type":"application/json"}),e.end(JSON.stringify(t))}}).listen(r,()=>{console.log(`Server is running at http://localhost:${r}/`)})}}}export{y as default};
